# hal_sensors_default.te

# cgroup tasks
allow hal_sensors_default cgroup:file getattr;

# /dev/iio:device1
allow hal_sensors_default iio_device:chr_file r_file_perms;

# /dev/ssp_sensorhub
allow hal_sensors_default ssp_device:chr_file rw_file_perms;

# /efs
allow hal_sensors_default efs_file:dir r_dir_perms;

# /efs/FactoryApp/
allow hal_sensors_default app_efs_file:dir rw_dir_perms;
allow hal_sensors_default app_efs_file:file { setattr rw_file_perms };

# /sys/bus/iio/devices
allow hal_sensors_default sysfs_iio:dir r_dir_perms;
allow hal_sensors_default sysfs_iio:file r_file_perms;

# /sys/class/sec
allow hal_sensors_default sysfs_sec:dir r_dir_perms;
allow hal_sensors_default sysfs_sec:file r_file_perms;

# /sys/devices/platform/10970000.spi/
allow hal_sensors_default sysfs_spi_writeable:dir r_dir_perms;
allow hal_sensors_default sysfs_spi_writeable:file rw_file_perms;

# /sys/devices/platform/panel@0/lcd/panel/window_type
allow hal_sensors_default sysfs_lcd_writable:dir r_dir_perms;
allow hal_sensors_default sysfs_lcd_writable:file r_file_perms;

# /sys/devices/virtual/input/input4
# /sys/devices/virtual/input/input6
allow hal_sensors_default sysfs_sensor_writable:dir r_dir_perms;
allow hal_sensors_default sysfs_sensor_writable:file rw_file_perms;

# /sys/devices/virtual/sensors/magnetic_sensor/vendor
allow hal_sensors_default sysfs_sensor_writable:dir r_dir_perms;
allow hal_sensors_default sysfs_sensor_writable:file r_file_perms;

# /sys/kernel/debug/tracing/trace_marker
allow hal_sensors_default debugfs_trace_marker:file getattr;
