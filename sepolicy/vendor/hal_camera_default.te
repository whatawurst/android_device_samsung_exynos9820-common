# hal_camera_default.te

vndbinder_use(hal_camera_default)

allow hal_camera_default hal_graphics_mapper_hwservice:hwservice_manager find;
get_prop(hal_camera_default, hwservicemanager_prop)

set_prop(hal_camera_default, sec_camera_prop)
set_prop(hal_camera_default, vendor_camera_prop)

add_hwservice(hal_camera_default, hal_vendor_multiframeprocessing_hwservice)
add_hwservice(hal_camera_default, hal_vendor_iva_hwservice)

# /acct/tasks
allow hal_camera_default cgroup:file getattr;

# /data/vendor/camera
allow hal_camera_default camera_vendor_data_file:dir rw_dir_perms;
allow hal_camera_default camera_vendor_data_file:file create_file_perms;

# /dev/jsqz
allow hal_camera_default jsqz_device:chr_file rw_file_perms;

# /sys/class/camera/
allow hal_camera_default sysfs_camera:dir r_dir_perms;
allow hal_camera_default sysfs_camera:file r_file_perms;

# /sys/kernel/ems/
allow hal_camera_default sysfs_ems:dir r_dir_perms;
allow hal_camera_default sysfs_ems:file r_file_perms;

# /sys/kernel/ems/frt/disable_cpufreq
allow hal_camera_default sysfs_ems:dir r_dir_perms;
allow hal_camera_default sysfs_ems_writable:file rw_file_perms;
